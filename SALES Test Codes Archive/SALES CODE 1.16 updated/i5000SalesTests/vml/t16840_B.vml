/*                                                                            */
/*   File    :  ~/dgn/src/i5000SalesTests/vml/t16840_vml                      */
/*   Purpose :                                                                */
/*       This is the vmc code file for t16840 { MAX DR CURRENT > 700mA SRC }  */
/*       This file sets the fclks per vector pair to 4 (2 fclks per vector),  */
/*       sets the drive levels to 0v drive low and a 5.00v drive high at .75A */
/*       and pulse high for a period of time long enough to reach a peak      */
/*       across the load.                                                     */
/*                                                                            */
/*   Compile using vmc                                                        */
/*      -  vmc <options> <directory>/<fnamr>                                  */
/*      -  compiler output goes to <directory>/<fnamr>.out                    */
/*      -  option "-debug 0" outputs a list of download data                  */
/*      -  option "-command" outputs a command list for a dgn source          */
/*      -  option "-makeasm" outputs a panel loadable file                    */
/*                                                                            */
/******************************************************************************/

setup

modules 1
pin_cards 1
fclks_per_vector_pair 4

end setup

/*-----------------------------------------------------------------------------
 * driver <label>
 * mod            0  // 'vmc -command' will be replaced with 'mod_id'
 * slot           2  // 'vmc -command' will be replaced with 'slot'
 * channel        <number>
 * [default]      0|1|k|t|x|z
 * fclks          <number>[(+|-)<delay>] <number[(+|-)<delay>]
 * [data src]     adrv0|adrv1|flip_flop|static0|static1
 * [3-state src]  adrv0|adrv1|flip_flop|static_en|static_dis
 *
 * receiver <label>
 * mod            0  // 'vmc -command' will be replaced with 'mod_id'
 * slot           2  // 'vmc -command' will be replaced with 'slot'
 * channel        <number>
 * [default]      0|1|k|t|x|z
 * fclks          <number>[(+|-)<delay>] <number[(+|-)<delay>]
 * [pull]         pull_up|pull_down
 * [clamp]        clamp_on|clamp_off
 * [rterm]        rterm_on|rterm_off
 *----------------------------------------------------------------------------*/
channel_section

  driver_range 0.0 3.5
  slew_rate 275

  driver   d101 mod 0 slot 2 channel 101 z fclks 1 3
  driver   d102 mod 0 slot 2 channel 102 z fclks 1 3
  driver   d103 mod 0 slot 2 channel 103 z fclks 1 3
  driver   d104 mod 0 slot 2 channel 104 z fclks 1 3
  driver   d105 mod 0 slot 2 channel 105 z fclks 1 3
  driver   d106 mod 0 slot 2 channel 106 z fclks 1 3
  driver   d107 mod 0 slot 2 channel 107 z fclks 1 3
  driver   d108 mod 0 slot 2 channel 108 z fclks 1 3
  driver   d109 mod 0 slot 2 channel 109 z fclks 1 3
  driver   d110 mod 0 slot 2 channel 110 z fclks 1 3
  driver   d111 mod 0 slot 2 channel 111 z fclks 1 3
  driver   d112 mod 0 slot 2 channel 112 z fclks 1 3
  driver   d113 mod 0 slot 2 channel 113 z fclks 1 3
  driver   d114 mod 0 slot 2 channel 114 z fclks 1 3
  driver   d115 mod 0 slot 2 channel 115 z fclks 1 3
  driver   d116 mod 0 slot 2 channel 116 z fclks 1 3
  driver   d117 mod 0 slot 2 channel 117 z fclks 1 3
  driver   d118 mod 0 slot 2 channel 118 z fclks 1 3
  driver   d121 mod 0 slot 2 channel 121 z fclks 1 3
  driver   d122 mod 0 slot 2 channel 122 z fclks 1 3
  driver   d123 mod 0 slot 2 channel 123 z fclks 1 3
  driver   d124 mod 0 slot 2 channel 124 z fclks 1 3
  driver   d125 mod 0 slot 2 channel 125 z fclks 1 3
  driver   d126 mod 0 slot 2 channel 126 z fclks 1 3
  driver   d127 mod 0 slot 2 channel 127 z fclks 1 3
  driver   d128 mod 0 slot 2 channel 128 z fclks 1 3
  driver   d129 mod 0 slot 2 channel 129 z fclks 1 3
  driver   d130 mod 0 slot 2 channel 130 z fclks 1 3
  driver   d131 mod 0 slot 2 channel 131 z fclks 1 3
  driver   d132 mod 0 slot 2 channel 132 z fclks 1 3
  driver   d133 mod 0 slot 2 channel 133 z fclks 1 3
  driver   d134 mod 0 slot 2 channel 134 z fclks 1 3
  driver   d135 mod 0 slot 2 channel 135 z fclks 1 3
  driver   d136 mod 0 slot 2 channel 136 z fclks 1 3
  driver   d137 mod 0 slot 2 channel 137 z fclks 1 3
  driver   d138 mod 0 slot 2 channel 138 z fclks 1 3
  driver   d141 mod 0 slot 2 channel 141 z fclks 1 3
  driver   d142 mod 0 slot 2 channel 142 z fclks 1 3
  driver   d143 mod 0 slot 2 channel 143 z fclks 1 3
  driver   d144 mod 0 slot 2 channel 144 z fclks 1 3
  driver   d145 mod 0 slot 2 channel 145 z fclks 1 3
  driver   d146 mod 0 slot 2 channel 146 z fclks 1 3
  driver   d147 mod 0 slot 2 channel 147 z fclks 1 3
  driver   d148 mod 0 slot 2 channel 148 z fclks 1 3
  driver   d149 mod 0 slot 2 channel 149 z fclks 1 3
  driver   d150 mod 0 slot 2 channel 150 z fclks 1 3
  driver   d151 mod 0 slot 2 channel 151 z fclks 1 3
  driver   d152 mod 0 slot 2 channel 152 z fclks 1 3
  driver   d153 mod 0 slot 2 channel 153 z fclks 1 3
  driver   d154 mod 0 slot 2 channel 154 z fclks 1 3
  driver   d155 mod 0 slot 2 channel 155 z fclks 1 3
  driver   d156 mod 0 slot 2 channel 156 z fclks 1 3
  driver   d157 mod 0 slot 2 channel 157 z fclks 1 3
  driver   d158 mod 0 slot 2 channel 158 z fclks 1 3
  driver   d161 mod 0 slot 2 channel 161 z fclks 1 3
  driver   d162 mod 0 slot 2 channel 162 z fclks 1 3
  driver   d163 mod 0 slot 2 channel 163 z fclks 1 3
  driver   d164 mod 0 slot 2 channel 164 z fclks 1 3
  driver   d165 mod 0 slot 2 channel 165 z fclks 1 3
  driver   d166 mod 0 slot 2 channel 166 z fclks 1 3
  driver   d167 mod 0 slot 2 channel 167 z fclks 1 3
  driver   d168 mod 0 slot 2 channel 168 z fclks 1 3
  driver   d169 mod 0 slot 2 channel 169 z fclks 1 3
  driver   d170 mod 0 slot 2 channel 170 z fclks 1 3
  driver   d171 mod 0 slot 2 channel 171 z fclks 1 3
  driver   d172 mod 0 slot 2 channel 172 z fclks 1 3
  driver   d173 mod 0 slot 2 channel 173 z fclks 1 3
  driver   d174 mod 0 slot 2 channel 174 z fclks 1 3
  driver   d175 mod 0 slot 2 channel 175 z fclks 1 3
  driver   d176 mod 0 slot 2 channel 176 z fclks 1 3
  driver   d177 mod 0 slot 2 channel 177 z fclks 1 3
  driver   d178 mod 0 slot 2 channel 178 z fclks 1 3
end channel_section

/******************************************************************************/

vector_section

   /*   vector <label> <vector length in tclks> <1st fclk> <2nd fclk>    */
   /*   vector addresses 0 through F are reserved     */
   /*   for seq, sys clk gen, and formatter startup   */

   org 0
	/* This vector MUST be at vector address 0 so NO fclks are generated on the first vector. */
   vector   v_slip_clk  2   256   256    end vector

   vector   v_flush     2     0     1
   end vector

   /*   begin real vectors at address 10H   */

   org 16 

   vector   drive_high          4   0   1
    d101 1  d102 1  d103 1  d104 1  d105 1  d106 1  d107 1  d108 1  d109 1
    d110 1  d111 1  d112 1  d113 1  d114 1  d115 1  d116 1  d117 1  d118 1
    d121 1  d122 1  d123 1  d124 1  d125 1  d126 1  d127 1  d128 1  d129 1
    d130 1  d131 1  d132 1  d133 1  d134 1  d135 1  d136 1  d137 1  d138 1
    d141 1  d142 1  d143 1  d144 1  d145 1  d146 1  d147 1  d148 1  d149 1
    d150 1  d151 1  d152 1  d153 1  d154 1  d155 1  d156 1  d157 1  d158 1
    d161 1  d162 1  d163 1  d164 1  d165 1  d166 1  d167 1  d168 1  d169 1
    d170 1  d171 1  d172 1  d173 1  d174 1  d175 1  d176 1  d177 1  d178 1
   end vector

   vector   drive_low         4   0   1
    d101 0  d102 0  d103 0  d104 0  d105 0  d106 0  d107 0  d108 0  d109 0
    d110 0  d111 0  d112 0  d113 0  d114 0  d115 0  d116 0  d117 0  d118 0
    d121 0  d122 0  d123 0  d124 0  d125 0  d126 0  d127 0  d128 0  d129 0
    d130 0  d131 0  d132 0  d133 0  d134 0  d135 0  d136 0  d137 0  d138 0
    d141 0  d142 0  d143 0  d144 0  d145 0  d146 0  d147 0  d148 0  d149 0
    d150 0  d151 0  d152 0  d153 0  d154 0  d155 0  d156 0  d157 0  d158 0
    d161 0  d162 0  d163 0  d164 0  d165 0  d166 0  d167 0  d168 0  d169 0
    d170 0  d171 0  d172 0  d173 0  d174 0  d175 0  d176 0  d177 0  d178 0
   end vector

end vector_section

/******************************************************************************/

sequence_section
   
   /*   <seq_label> <vect_label> [crc, sync]   */
   
   /*   sequence ram pointers 0 through F are reserved   */
   /*   for seq, sys clk gen, and formatter startup      */

   org 0

  s_flush    	v_flush
  s_flush_0001 	v_flush
  s_flush_0002 	v_flush
  s_flush_0003 	v_flush
  s_flush_0004 	v_flush
  s_flush_0005 	v_flush
  s_flush_0006 	v_flush
  s_flush_0007 	v_flush
  s_flush_0008 	v_flush
  s_flush_0009 	v_flush
  s_flush_000A 	v_flush
  s_flush_000B 	v_flush
  s_flush_000C 	v_flush
  s_flush_000D 	v_flush
  s_flush_000E 	v_flush
  s_flush_000F 	v_flush

   /*   begin real pointers at address 10H   */

   org 16 
   
   s_drive_high    drive_high         
   s_drive_low     drive_low

end sequence_section

/******************************************************************************/

program_section

   /*   directory ram pointers 0 through F are reserved   */
   /*   for seq, sys clk gen, and formatter startup       */

   org 0

   /*   this section is the startup for the 2 fclk per vector mode   */
   /*   this section is the startup for the 3 fclk per vector mode   */
   /*   this section is the startup for the 4 fclk per vector mode   */

   p_startup_0                      apply s_flush with vceoff, nop
   p_startup_1                      apply s_flush with nop
   p_startup_2                      apply s_flush with nop
   p_startup_3 jmp to p_drive_high, apply s_flush with nop

   /* start real program at address 10H */

   org 16 
   
   p_drive_high                      apply s_drive_high  with vceon
   p_drive_low_1                     apply s_drive_low
   p_drive_low_2 jmp to p_drive_high apply s_drive_low
  
   /* end   real program   */
   
   p_off						apply s_flush	with      vceon
   p_halt_flush_sls   sls 13    apply s_flush   with nop
   p_halt_assert                apply s_flush   with vceoff, nop, halt
   p_halt_dis_vcen              apply s_flush   with nop
   p_halt_flush                 apply s_flush   with nop

end program_section
